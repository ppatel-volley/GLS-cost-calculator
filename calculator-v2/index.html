<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoComelon Infrastructure Cost Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Oxygen', 'Ubuntu', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
            color: #2c3e50;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.12);
            overflow: visible;
            backdrop-filter: blur(10px);
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            border-radius: 16px 16px 0 0;
            position: relative;
        }
        
        .header::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1);
        }

        .header h1 {
            font-size: 2.6rem;
            margin-bottom: 12px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            letter-spacing: -0.02em;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.95;
            font-weight: 300;
            max-width: 600px;
            margin: 0 auto;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
        }

        .config-panel {
            background: linear-gradient(180deg, #f8f9fb 0%, #f1f3f7 100%);
            padding: 32px;
            border-right: 1px solid #e2e8f0;
            max-height: 80vh;
            overflow-y: auto;
        }

        .results-panel {
            padding: 32px;
            max-height: 80vh;
            overflow-y: auto;
            background: #ffffff;
        }

        .section {
            margin-bottom: 30px;
        }

        .section h3 {
            color: #2d3436;
            margin-bottom: 18px;
            font-size: 1.35rem;
            font-weight: 600;
            border-bottom: 3px solid #667eea;
            padding-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-description {
            background: linear-gradient(135deg, #e8f4fd 0%, #f0f8ff 100%);
            padding: 18px;
            border-radius: 8px;
            margin-bottom: 24px;
            border-left: 4px solid #667eea;
            font-size: 0.92rem;
            color: #1e3a8a;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 5px;
            color: #2d3436;
            font-size: 0.9rem;
        }

        .label-with-tooltip {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: #333;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            line-height: 1.4;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .tooltip-icon {
            background: #2196f3;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: #ffffff;
            font-weight: 500;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
            transform: translateY(-1px);
        }

        .hourly-pattern {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-top: 10px;
        }

        .hour-block {
            text-align: center;
        }

        .hour-label {
            font-size: 10px;
            font-weight: 600;
            margin-bottom: 4px;
            color: #666;
            line-height: 1.2;
        }

        .hour-label.peak {
            color: #d32f2f;
            background: #ffebee;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .hour-label.off-peak {
            color: #1976d2;
            background: #e3f2fd;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .hourly-input {
            width: 100%;
            text-align: center;
            padding: 6px 4px;
            font-size: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .hourly-input.peak {
            border-color: #f44336;
            background: #fff5f5;
        }

        .hourly-input.off-peak {
            border-color: #2196f3;
            background: #f8fbff;
        }

        .pattern-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0 10px 0;
            font-size: 0.85rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }

        .peak-legend { background: #ffebee; border: 1px solid #f44336; }
        .off-peak-legend { background: #e3f2fd; border: 1px solid #2196f3; }

        .calculate-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 18px 32px;
            font-size: 1.1rem;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .calculate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4c93 100%);
        }

        .calculate-btn:active {
            transform: translateY(0);
        }

        @keyframes flash {
            0% { background: #28a745; }
            50% { background: #20c997; }
            100% { background: #28a745; }
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .result-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .result-card h4 {
            color: #2d3436;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
        }

        .metric-label {
            color: #636e72;
            font-size: 0.9rem;
        }

        .metric-value {
            font-weight: 600;
            color: #2d3436;
        }

        .month-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .month-tab {
            background: #e9ecef;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .month-tab.active {
            background: #667eea;
            color: white;
        }

        .month-tab:hover {
            background: #495057;
            color: white;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error {
            background: #ffe6e6;
            color: #d63031;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border: 1px solid #fab1a0;
        }

        .instance-config {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .instance-config h5 {
            margin-bottom: 10px;
            color: #2d3436;
            font-size: 1rem;
        }

        .instance-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 10px;
        }

        .cost-highlight {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #4caf50;
            margin-top: 20px;
        }

        .cost-highlight h4 {
            color: #2e7d32;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .hourly-pattern {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        .chart-container {
            margin-top: 20px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎮 CoComelon Infrastructure Calculator</h1>
            <p>Pure infrastructure cost modeling - configure usage patterns and see real capacity needs</p>
        </div>

        <div class="main-content">
            <!-- Configuration Panel -->
            <div class="config-panel">
                <div class="section">
                    <h3>🧸 Child Usage Model (Ages 1.5-5)</h3>
                    <div class="section-description">
                        Configure child-specific usage patterns for toddlers and preschoolers. This replaces generic adult usage models with behavior patterns specific to young children's schedules, attention spans, and parental supervision.
                    </div>

                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>Usage Model</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltiptext">Choose between specialized child patterns (ages 1.5-5) with automatic behavioral modeling, or generic patterns for all ages. Child model includes nap times, bedtime routines, attention spans, timezone-aware scheduling, and parental supervision patterns.</span>
                            </div>
                        </div>
                        <select id="child_model_enabled">
                            <option value="true">🧸 Child Model (Ages 1.5-5) - 8% Peak Concurrent</option>
                            <option value="false">👥 Generic Model (All Ages) - 10% Peak Concurrent</option>
                        </select>
                    </div>

                    <div id="child_model_explanation" style="background: #f8f9ff; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #4a90e2;">
                        <h4 style="margin: 0 0 10px 0; color: #2c5aa0; font-size: 0.95rem;">🧸 Child Model Includes Automatically:</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; font-size: 0.85rem;">
                            <div><strong>📅 Daily Schedules:</strong> Weekday vs weekend patterns, nap times (1-3 PM), bedtime routines (6:30-8 PM)</div>
                            <div><strong>🌍 Timezone Awareness:</strong> Local time calculations across US timezones with staggered peak distribution</div>
                            <div><strong>👶 Age Demographics:</strong> Mixed population (30% toddlers, 40% preschoolers, 30% pre-K)</div>
                            <div><strong>👨‍👩‍👧 Supervision Patterns:</strong> Parental supervision ratios, distraction-driven usage spikes</div>
                            <div><strong>⏱️ Attention Spans:</strong> Age-appropriate session durations (8-18 min), attention volatility modeling</div>
                            <div><strong>🏠 Schedule Types:</strong> Daycare (40%), stay-at-home (35%), mixed schedules (25%)</div>
                        </div>
                        <div style="margin-top: 12px; padding: 10px; background: #e8f4fd; border-radius: 6px; font-size: 0.8rem; color: #555;">
                            <strong>✨ Population-Level Modeling:</strong> All behavioral patterns are applied automatically based on research-backed assumptions for children's streaming habits. No individual configuration needed - the system models realistic population-wide usage patterns.
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>👥 User Base & Growth</h3>
                    <div class="section-description">
                        Configure your current user base and growth projections. These drive how much infrastructure capacity you'll need each month.
                    </div>

                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>Current Daily Active Users (DAU)</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltiptext">How many unique users use your service each day. This is your starting point for growth calculations.</span>
                            </div>
                        </div>
                        <input type="number" id="current_dau" value="4140" min="0">
                    </div>

                    <div class="form-group" id="generic_concurrent_ratio" style="display: none;">
                        <div class="label-with-tooltip">
                            <label>Peak Concurrent Ratio (Generic Model)</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltiptext">What percentage of your daily users are online at the same time during peak hours. Generic model uses fixed ratio regardless of time of day.</span>
                            </div>
                        </div>
                        <input type="number" id="peak_concurrent_ratio" value="0.10" min="0" max="1" step="0.01">
                    </div>

                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>Monthly Growth Rate</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltiptext">How fast your user base grows each month. 10% = doubles every 7 months, 20% = doubles every 4 months. Growing platforms often see 10-25% monthly growth.</span>
                            </div>
                        </div>
                        <input type="number" id="monthly_growth_rate" value="0.10" min="0" max="1" step="0.01">
                    </div>

                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>Household Percentage (Research-Based)</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltiptext">Research shows 45% of current users are households with children interested in CoComelon content. Lower than initially expected due to individual account prevalence.</span>
                            </div>
                        </div>
                        <input type="number" id="household_percentage" value="0.45" min="0" max="1" step="0.01">
                    </div>

                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>User Retention Rate</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltiptext">Percentage of users who continue using the service each month. 88% means you retain 88% of users from the previous month. Typical retention rates range from 70-95% depending on product engagement.</span>
                            </div>
                        </div>
                        <input type="number" id="user_retention_rate" value="0.88" min="0" max="1" step="0.01">
                    </div>

                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>Growth Logic Explanation</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">ℹ️</span>
                                <span class="tooltiptext">How the user calculations work across months.</span>
                            </div>
                        </div>
                        <div style="background: #e8f4f8; padding: 15px; border-radius: 6px; font-size: 0.9em; color: #2c5aa0;">
                            <strong>Month 1:</strong> (Current DAU × <span id="household_display">45</span>% household filter) + Marketing targets<br>
                            <strong>Month 2+:</strong> (Previous users × <span id="retention_display">88</span>% retention) + New marketing acquisitions<br>
                            <strong>Marketing Control:</strong> Direct monthly acquisition targets - all new users assumed CoComelon users
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>📈 Marketing Acquisition (12-Month Plan)</h3>
                    <div class="section-description">
                        Configure your marketing-driven new user acquisition targets for each month. These targets can be adjusted based on marketing budget, campaigns, and market conditions.
                    </div>
                    
                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>New User Assumptions</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">ℹ️</span>
                                <span class="tooltiptext">Simplified for capacity planning: All new users are CoComelon users. Marketing inputs direct monthly acquisition numbers.</span>
                            </div>
                        </div>
                        <div style="background: #f0f8ff; padding: 15px; border-radius: 6px; font-size: 0.9em; color: #1e3a8a;">
                            <strong>✅ All new users = CoComelon users</strong> (for capacity planning)<br>
                            <strong>📊 Marketing inputs monthly targets directly</strong> (no complex multipliers)
                        </div>
                    </div>

                    <div class="acquisition-targets">
                        <h4>Monthly New User Targets</h4>
                        <div class="targets-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div class="target-input">
                                <label>Month 1</label>
                                <input type="number" id="target_month_1" value="500" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 2</label>
                                <input type="number" id="target_month_2" value="1200" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 3</label>
                                <input type="number" id="target_month_3" value="2000" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 4</label>
                                <input type="number" id="target_month_4" value="2500" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 5</label>
                                <input type="number" id="target_month_5" value="2200" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 6</label>
                                <input type="number" id="target_month_6" value="2000" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 7</label>
                                <input type="number" id="target_month_7" value="1800" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 8</label>
                                <input type="number" id="target_month_8" value="1600" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 9</label>
                                <input type="number" id="target_month_9" value="1500" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 10</label>
                                <input type="number" id="target_month_10" value="1400" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 11</label>
                                <input type="number" id="target_month_11" value="1800" min="0" step="50">
                            </div>
                            <div class="target-input">
                                <label>Month 12</label>
                                <input type="number" id="target_month_12" value="2200" min="0" step="50">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="section">
                    <h3>🕐 Hourly Usage Patterns</h3>
                    <div class="section-description">
                        Configure when your users are most active throughout the day. These patterns drive your infrastructure costs since you need more servers during peak hours.
                        <br><br>
                        <strong>Usage Multipliers:</strong> 1.0 = 100% of peak concurrent users online, 0.5 = 50% online, 0.1 = 10% online
                    </div>

                    <div class="pattern-legend">
                        <div class="legend-item">
                            <div class="legend-color peak-legend"></div>
                            <span>Peak Hours (high server needs)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color off-peak-legend"></div>
                            <span>Off-Peak Hours (low server needs)</span>
                        </div>
                    </div>
                    
                    <h5>Weekday Pattern (School Days)</h5>
                    <div class="hourly-pattern" id="weekday_pattern"></div>
                    
                    <h5 style="margin-top: 20px;">Weekend Pattern (Saturday/Sunday)</h5>
                    <div class="hourly-pattern" id="weekend_pattern"></div>
                </div>

                <div class="section">
                    <h3>💻 Server Instance Type</h3>
                    <div class="section-description">
                        Using <strong>gen4n_mid (NVIDIA T4 - Mid capacity)</strong>: 6 sessions per host at $0.77/hour. This is the optimal balance of performance and cost-efficiency.
                    </div>
                </div>

                <div class="section">
                    <h3>⚙️ Capacity Planning</h3>
                    <div class="section-description">
                        Configure buffer capacity and storage needs to ensure reliable service during unexpected spikes.
                    </div>
                    
                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>Peak Buffer Percentage</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltiptext">Extra capacity during peak hours to handle unexpected spikes. 15% means if you need 10 servers, you'll provision 11-12 servers for safety.</span>
                            </div>
                        </div>
                        <input type="number" id="peak_buffer_percentage" value="0.15" min="0" max="1" step="0.01">
                    </div>

                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>Storage Required (GB)</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltiptext">How much storage you need for game assets, user data, etc. This adds a fixed monthly cost regardless of user count.</span>
                            </div>
                        </div>
                        <input type="number" id="storage_gb_required" value="100" min="0">
                    </div>

                    <div class="form-group">
                        <div class="label-with-tooltip">
                            <label>Storage Cost per GB/Month ($)</label>
                            <div class="tooltip">
                                <span class="tooltip-icon">?</span>
                                <span class="tooltiptext">How much you pay per GB of storage per month. AWS S3 is typically $0.023-0.03/GB/month depending on usage.</span>
                            </div>
                        </div>
                        <input type="number" id="storage_cost_per_gb_month" value="0.03" min="0" step="0.001">
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculateResults()">
                    🚀 Calculate Infrastructure Costs
                </button>
            </div>

            <!-- Results Panel -->
            <div class="results-panel">
                <div class="section">
                    <h3>📊 Infrastructure Cost Results</h3>
                    <div class="month-tabs" id="month_tabs"></div>
                    <div id="results_content">
                        <div class="loading">
                            Click "Calculate Infrastructure Costs" to see your server capacity needs and costs
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Handle child model toggle
        function toggleChildModel() {
            // Auto-save settings when child model toggle changes
            if (typeof autoSaveConfig === 'function') {
                autoSaveConfig();
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Set up event listener for child model toggle
            const childModelSelect = document.getElementById('child_model_enabled');
            if (childModelSelect) {
                childModelSelect.addEventListener('change', toggleChildModel);

                // Auto-save initial settings
                if (typeof autoSaveConfig === 'function') {
                    autoSaveConfig();
                }
            }
        });
    </script>
    <script src="calculator.js"></script>
</body>
</html>
